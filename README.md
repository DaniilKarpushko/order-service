# Order Service

## Task 1 — Конфигурации и бизнес-логика

Реализован клиент внешнего сервиса конфигураций с двумя вариантами: ручной (`HttpClient`) и через Refit. Оба работают по общему интерфейсу и поддерживают пагинацию.

Создан кастомный `ConfigurationProvider`, обновляющийся через обслуживающий сервис с таймером. Провайдер не делает запросы сам и не перезагружает данные при отсутствии изменений.

Разработаны репозитории и сервисы для работы с товарами, заказами, позициями заказов и их историей. Все CRUD-операции реализованы с учетом транзакционности, пагинации и сериализации истории. Миграции выполнены через FluentMigrator. Конфигурация БД — через `IOptions`, подключение — через Npgsql.

---

## Task 2 — Интеграция в ASP.NET Core

Функционал из Task 1 интегрирован в ASP.NET-приложение. Сервис обновления конфигураций и запуск миграций работают как фоновые сервисы. Все настройки и зависимости подключаются через DI. Эндпоинты имеют документацию в Swagger и обрабатываются через централизованный middleware ошибок.

---

## Task 3 — gRPC и Kafka-интеграция

Добавлен gRPC API для сервиса заказов и HTTP Gateway-приложение, проксирующее запросы. Поддерживается полиморфизм в моделях (`oneof` для gRPC, обычные типы для HTTP). Ошибки обрабатываются через Interceptor и middleware.

Интеграция с Kafka: реализованы producer и consumer с абстракциями и параметризацией через `Options`. Сервис заказов пишет события в `order_creation` и читает `order_processing`, обновляя статус заказа и ведя историю. Возможность завершить заказ вручную исключена — только через событие доставки.

